<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AcquaVig</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    :root {
      --cor-principal: #00796b;
      --cor-hover: #004d40;
      --cor-botao-dark: #26a69a;
      --fundo-light: #e0f7fa;
      --fundo-dark: #121212;
      --texto-light: #000;
      --texto-dark: #e0e0e0;
    }
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      transition: background-color 0.5s, color 0.5s;
    }
    .dark-mode {
      background-color: var(--fundo-dark);
      color: var(--texto-dark);
    }
    .light-mode {
      background-color: var(--fundo-light);
      color: var(--texto-light);
    }
    header, section, #telaLogin > div, #modalCadastro > div {
      padding: 20px;
      margin: 20px auto;
      width: 100%;
      max-width: 800px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    #telaLogin, #modalCadastro {
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }
    #telaLogin.show, #modalCadastro.show {
      display: block;
      opacity: 1;
    }
    .dark-mode header,
    .dark-mode section,
    .dark-mode #telaLogin > div,
    .dark-mode #modalCadastro > div {
      background: #1e1e1e;
    }
    h1, h2, h3, h4 {
      color: var(--cor-principal);
      margin-bottom: 10px;
    }
    input, button {
      padding: 12px;
      margin: 8px 0;
      width: 100%;
      max-width: 400px;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    button {
      background-color: var(--cor-principal);
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: var(--cor-hover);
      transform: scale(1.03);
    }
    .dark-mode button {
      background-color: var(--cor-botao-dark);
    }
    #modoEscuroBtn {
      position: fixed;
      bottom: 10px;
      left: 10px;
      font-size: 24px;
      background: transparent;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 50%;
      z-index: 10001;
      box-shadow: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    #modoEscuroBtn:hover {
      background: rgba(0, 0, 0, 0.1);
    }
    #inicio {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    #inicio > div {
      background: white;
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      width: 320px;
      transition: background 0.3s;
    }
    .dark-mode #inicio > div {
      background: #2c2c2c;
    }
    #inicio img {
      width: 100px;
      margin-bottom: 15px;
    }
    #inicio p {
      margin: 10px 0 20px;
      font-size: 15px;
      color: #444;
    }
    .dark-mode #inicio p {
      color: #ccc;
    }
    #mapaManaus {
      height: 400px;
      width: 100%;
      max-width: 800px;
      margin: 20px auto;
      border-radius: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .escondido {
      display: none;
    }
    #barraPerfil {
      background-color: var(--cor-principal);
      color: white;
      padding: 12px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 10000;
    }
    #barraPerfil .botoes {
      display: flex;
      gap: 10px;
    }
    #barraPerfil button {
      background: white;
      color: var(--cor-principal);
      padding: 8px 16px;
      border-radius: 6px;
      border: none;
    }
  </style>
</head>
<body class="light-mode">
  <button id="modoEscuroBtn" onclick="alternarModo()"><i class="fas fa-moon"></i></button>
  <div id="inicio">
    <div>
      <img src="https://cdn-icons-png.flaticon.com/512/4278/4278671.png" alt="Logo AcquaVig">
      <h2>Bem-vindo ao AcquaVig</h2>
      <p>Monitore a qualidade dos igarap√©s de Manaus com dados em tempo real e visualiza√ß√£o interativa.</p>
      <button onclick="abrirLogin()"><i class="fas fa-sign-in-alt"></i> Login</button>
      <button onclick="abrirCadastro()"><i class="fas fa-user-plus"></i> Cadastro</button>
      <button onclick="entrarComoVisitante()"><i class="fas fa-user"></i> Entrar como visitante</button>
    </div>
  </div>

  <div id="telaLogin" class="escondido">
    <div>
      <h2>Login</h2>
      <input type="text" id="usuario" placeholder="Usu√°rio">
      <input type="password" id="senha" placeholder="Senha">
      <button onclick="fazerLogin()">Entrar</button>
      <p id="erroLogin" style="color: red;"></p>
    </div>
  </div>

 <!--ABA DE CADASTRO-->

 <div id="telaCadastro" class="escondido">
  <div>
    <h2>Cadastro</h2>
    <form id="formCadastro" onsubmit="realizarCadastro(event)">
      <div class="form-group">
        <label for="nomeCadastro">Nome Completo</label>
        <input type="text" id="nomeCadastro" placeholder="Nome Completo" required>
      </div>
      <div class="form-group">
        <label for="emailCadastro">E-mail</label>
        <input type="email" id="emailCadastro" placeholder="E-mail" required>
      </div>
      <div class="form-group">
        <label for="telefoneCadastro">Telefone</label>
        <input type="tel" id="telefoneCadastro" placeholder="Telefone (opcional)">
      </div>
      <div class="form-group">
        <label for="senhaCadastro">Senha</label>
        <input type="password" id="senhaCadastro" placeholder="Senha" required>
      </div>
      <div class="form-group">
        <label for="confirmarSenhaCadastro">Confirmar Senha</label>
        <input type="password" id="confirmarSenhaCadastro" placeholder="Confirmar Senha" required>
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" id="termosCadastro" required>
          Aceito os <a href="#" target="_blank">termos de uso</a>
        </label>
      </div>
      <button type="submit" class="btn">Cadastrar</button>
      <p id="erroCadastro" class="erro"></p>
    </form>
    <button onclick="voltarLogin()">Voltar ao Login</button>
  </div>
</div>

<style>
  
  /* Estilos b√°sicos para responsividade */
  .modal {
  display: flex;
  justify-content: center;
  align-items: center;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
}

.modal-content {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  overflow: hidden; /* Garantir que nada ultrapasse os limites */
}

.form-group {
  margin-bottom: 15px;
}

.form-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group input[type="password"],
.form-group input[type="tel"] {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
  overflow: hidden;
}

.form-group input[type="checkbox"] {
  margin-right: 5px;
}

.btn {
  width: 100%;
  padding: 10px;
  background-color: #00796b;
  color: #e0f7fa;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
}

.btn:hover {
  background-color: #26a69a;
}

.erro {
  color: red;
  font-size: 14px;
  margin-top: 10px;
}

.modal-content h2 {
  text-align: center;
}
</style>

  <div id="barraPerfil" class="escondido">
    <span>üë§ Visitante</span>
    <div class="botoes">
      <button onclick="confirmarSaida()">Sair</button>
    </div>
  </div>

  <header>
    <h1>Monitoramento de Igarap√©s - AcquaVig</h1>
    <p>Este site ajuda a monitorar o n√≠vel de toxidade dos igarap√©s de Manaus por bairro.</p>
  </header>

  <section>
    <h2>Selecione seu bairro:</h2>
    <input type="text" id="bairro" list="bairros" placeholder="Digite seu bairro...">
    <button onclick="analisarBairro()">Enviar</button>
    <button onclick="localizarUsuario()">üìç Localizar meu bairro</button>
    <datalist id="bairros">
      <option value="Centro">
      <option value="Adrian√≥polis">
      <option value="Alvorada">
      <option value="Aparecida">
      <option value="Cidade Nova">
      <option value="Compensa">
      <option value="Dom Pedro">
      <option value="Japiim">
      <option value="Ponta Negra">
      <option value="Tarum√£">
    </datalist>
    <div id="resultado"></div>
  </section>

  <div id="mapaManaus"></div>

  <canvas id="graficoToxidade" style="max-width: 800px; margin: 20px auto; display: block;"></canvas>

  <section>
    <h4>Sobre:</h4>
    <p>Este sistema monitora igarap√©s de Manaus com sensores de pH, turbidez e temperatura. Os dados s√£o analisados e exibidos neste painel interativo.</p>
  </section>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const bairros = {
      "Centro": [-3.1316, -60.0239],
      "Adrian√≥polis": [-3.1013, -60.0101],
      "Alvorada": [-3.0901, -60.0464],
      "Aparecida": [-3.1333, -60.0236],
      "Cidade Nova": [-3.0467, -59.9806],
      "Compensa": [-3.1061, -60.0658],
      "Dom Pedro": [-3.0961, -60.0326],
      "Japiim": [-3.1183, -59.9942],
      "Ponta Negra": [-3.0827, -60.1403],
      "Tarum√£": [-3.0208, -60.1053]
    };

    const toxidades = {
      "Centro": 2,
      "Adrian√≥polis": 1,
      "Alvorada": 3,
      "Aparecida": 2,
      "Cidade Nova": 1,
      "Compensa": 4,
      "Dom Pedro": 3,
      "Japiim": 2,
      "Ponta Negra": 1,
      "Tarum√£": 5
    };

    const map = L.map('mapaManaus').setView([-3.119, -60.021], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    for (const bairro in bairros) {
      const coords = bairros[bairro];
      const nivel = toxidades[bairro];
      const cor = ["#4caf50", "#ffeb3b", "#ff9800", "#f44336", "#b71c1c"][nivel - 1];
      L.circle(coords, {
        color: cor,
        fillColor: cor,
        fillOpacity: 0.5,
        radius: 500
      }).addTo(map).bindPopup(`${bairro}: N√≠vel de toxidade ${nivel}`);
    }

    function analisarBairro() {
      const bairro = document.getElementById("bairro").value;
      const nivel = toxidades[bairro];
      document.getElementById("resultado").innerHTML =
        nivel ? `O n√≠vel de toxidade em <strong>${bairro}</strong> √© <strong>${nivel}</strong>.` : "Bairro n√£o encontrado.";
    }

    function localizarUsuario() {
      navigator.geolocation?.getCurrentPosition((pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        map.setView([lat, lon], 14);
        L.marker([lat, lon]).addTo(map).bindPopup("üìç Voc√™ est√° aqui!").openPopup();
      }, () => alert("N√£o foi poss√≠vel localizar sua posi√ß√£o."));
    }

    function fazerLogin() {
      const usuario = document.getElementById("usuario").value;
      const senha = document.getElementById("senha").value;
      if (usuario === "admin" && senha === "1234") {
        document.getElementById("inicio").style.display = "none";
        document.getElementById("telaLogin").classList.add("escondido");
        document.getElementById("barraPerfil").classList.remove("escondido");
      } else {
        document.getElementById("erroLogin").textContent = "Usu√°rio ou senha incorretos!";
      }
    }

    function realizarCadastro() {
      const senha = document.getElementById("senhaCadastro").value;
      const confirmar = document.getElementById("confirmarSenhaCadastro").value;
      const erro = document.getElementById("erroCadastro");
      if (senha !== confirmar) {
        erro.textContent = "As senhas n√£o coincidem!";
      } else {
        alert("Cadastro realizado!");
        document.getElementById("modalCadastro").classList.add("escondido");
        document.getElementById("inicio").style.display = "none";
        document.getElementById("barraPerfil").classList.remove("escondido");
      }
    }

    function abrirLogin() {
      document.getElementById("inicio").style.display = "none";
      document.getElementById("telaLogin").classList.add("show");
    }

    function abrirCadastro() {
      document.getElementById("inicio").style.display = "none";
      document.getElementById("modalCadastro").classList.add("show");
    }

    function entrarComoVisitante() {
      document.getElementById("inicio").style.display = "none";
      document.getElementById("barraPerfil").classList.remove("escondido");
    }

    function alternarModo() {
      const body = document.body;
      const isDark = body.classList.toggle("dark-mode");
      body.classList.toggle("light-mode", !isDark);
      localStorage.setItem("modoEscuro", isDark ? "true" : "false");
    }

    function confirmarSaida() {
      Swal.fire({
        title: 'Tem certeza?',
        text: "Voc√™ deseja sair do AcquaVig?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#00796b',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Sim, sair',
        cancelButtonText: 'Cancelar'
      }).then((result) => {
        if (result.isConfirmed) {
          location.reload();
        }
      });
    }

    window.addEventListener("DOMContentLoaded", () => {
      const preferencia = localStorage.getItem("modoEscuro");
      if (preferencia === "true") {
        document.body.classList.add("dark-mode");
        document.body.classList.remove("light-mode");
      } else {
        document.body.classList.add("light-mode");
        document.body.classList.remove("dark-mode");
      }

      const ctx = document.getElementById('graficoToxidade').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(toxidades),
          datasets: [{
            label: 'N√≠vel de Toxidade',
            data: Object.values(toxidades),
            backgroundColor: Object.values(toxidades).map(n => ["#4caf50", "#ffeb3b", "#ff9800", "#f44336", "#b71c1c"][n - 1])
          }]
        },
        options: {
  responsive: true,
  scales: {
    y: {
      beginAtZero: true,
      max: 10, // AUMENTADO DE 5 PARA 10
      title: {
        display: true,
        text: 'N√≠vel'
      }
    }
  }
}

      });
    });
  </script>
</body>
</html>
